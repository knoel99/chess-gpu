<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>‚ôü R√©seau de neurones vs Stockfish (Elo 1350)</title>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: system-ui, sans-serif; background: #1a1a2e; color: #eee;
         display: flex; flex-direction: column; align-items: center; padding: 20px; }
  h1 { margin-bottom: 10px; }
  .score { font-size: 1.2em; margin-bottom: 20px; color: #aaa; }
  .game-select { margin-bottom: 15px; }
  select, button { font-size: 16px; padding: 8px 16px; border-radius: 6px;
                    border: none; cursor: pointer; margin: 0 4px; }
  select { background: #16213e; color: #eee; }
  button { background: #0f3460; color: #eee; }
  button:hover { background: #533483; }
  button:disabled { opacity: 0.3; cursor: default; }
  #board { font-size: 0; margin: 10px 0; }
  .row { display: flex; }
  .sq { width: 60px; height: 60px; display: flex; align-items: center;
         justify-content: center; font-size: 44px; user-select: none;
         text-shadow: none; }
  .light { background: #f0d9b5; }
  .dark { background: #b58863; }
  .white-piece { color: #fff; text-shadow: 0 0 2px #000, 0 0 2px #000, 1px 1px 1px #000; }
  .black-piece { color: #000; text-shadow: 0 0 2px rgba(255,255,255,0.3); }
  .highlight { box-shadow: inset 0 0 0 3px #f5c542; }
  .players { display: flex; justify-content: space-between; width: 480px;
              margin-bottom: 5px; font-size: 14px; }
  .player-bar { display: flex; align-items: center; gap: 8px; padding: 6px 12px;
                 border-radius: 6px; }
  .player-bar.top { background: #222; }
  .player-bar.bottom { background: #ddd; }
  .player-dot { width: 16px; height: 16px; border-radius: 50%; border: 2px solid #888; }
  .player-dot.white { background: #fff; }
  .player-dot.black { background: #000; }
  .player-name { font-weight: bold; }
  .player-bar.top .player-name { color: #ccc; }
  .player-bar.bottom .player-name { color: #333; }
  .player-tag { font-size: 11px; padding: 2px 6px; border-radius: 3px; font-weight: normal; }
  .player-tag.model { background: #533483; color: #fff; }
  .player-tag.stockfish { background: #0f3460; color: #fff; }
  .player-bar .turn-indicator { font-size: 11px; color: #f5c542; font-weight: bold;
                                  margin-left: auto; }
  .board-container { border: 2px solid #555; border-radius: 4px; overflow: hidden; }
  .info { margin-top: 15px; font-size: 14px; color: #aaa; text-align: center; }
  .move-list { max-width: 500px; margin-top: 10px; font-family: monospace;
                font-size: 13px; color: #ccc; line-height: 1.6; word-wrap: break-word;
                text-align: center; }
  .move-list .current { color: #f5c542; font-weight: bold; }
</style>
</head>
<body>
<h1>‚ôü R√©seau de neurones vs Stockfish</h1>
<div class="score">0W - 0D - 10L ‚îÇ Elo Stockfish: ~1350</div>

<div class="game-select">
  <select id="gameSelect" onchange="loadGame(this.value)"></select>
</div>
<div id="topPlayer" class="player-bar top" style="width:480px">
  <div class="player-dot black"></div>
  <span class="player-name" id="blackName">Noirs</span>
  <span class="player-tag" id="blackTag"></span>
  <span class="turn-indicator" id="blackTurn"></span>
</div>
<div class="board-container"><div id="board"></div></div>
<div id="bottomPlayer" class="player-bar bottom" style="width:480px">
  <div class="player-dot white"></div>
  <span class="player-name" id="whiteName">Blancs</span>
  <span class="player-tag" id="whiteTag"></span>
  <span class="turn-indicator" id="whiteTurn"></span>
</div>
<div>
  <button onclick="goTo(0)">‚èÆ</button>
  <button onclick="step(-1)">‚óÄ</button>
  <button id="playBtn" onclick="togglePlay()">‚ñ∂ Play</button>
  <button onclick="step(1)">‚ñ∂</button>
  <button onclick="goTo(positions.length-1)">‚è≠</button>
</div>
<div class="info" id="info"></div>
<div class="move-list" id="moveList"></div>

<script>
const PIECES = {
  'P':'‚ôü','N':'‚ôû','B':'‚ôù','R':'‚ôú','Q':'‚ôõ','K':'‚ôö',
  'p':'‚ôü','n':'‚ôû','b':'‚ôù','r':'‚ôú','q':'‚ôõ','k':'‚ôö'
};
const WHITE_PIECES = new Set(['P','N','B','R','Q','K']);
const pgns = ["[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"R\u00e9seau de neurones\"]\n[Black \"Stockfish\"]\n[Result \"0-1\"]\n\n1. e4 { p=0.430 legal=20 } 1... c6 2. d4 { p=0.475 legal=30 } 2... d6 3. Nc3 { p=0.527 legal=38 } 3... d5 4. e5 { p=0.001 legal=39 } 4... Bd7 5. Nf3 { p=0.068 legal=39 } 5... Bf5 6. Bd3 { p=0.005 legal=36 } 6... Bg6 7. O-O { p=0.008 legal=41 } 7... e6 8. Ne2 { p=0.007 legal=36 } 8... Ne7 9. Ng3 { p=0.009 legal=33 } 9... a5 10. c3 { p=0.046 legal=35 } 10... Nd7 11. Re1 { p=0.054 legal=39 } 11... Bxd3 12. Qxd3 { p=0.960 legal=33 } 12... Qb6 13. h4 { p=0.030 legal=43 } 13... c5 14. h5 { p=0.123 legal=44 } 14... h6 15. dxc5 { p=0.057 legal=43 } 15... Qc6 16. Qd4 { p=0.063 legal=45 } 16... g5 17. b4 { p=0.095 legal=40 } 17... Qc7 18. b5 { p=0.050 legal=40 } 18... Qxc5 19. Be3 { p=0.050 legal=41 } 19... Rc8 20. Qxc5 { p=0.045 legal=40 } 20... Nxc5 21. Nd4 { p=0.112 legal=31 } 21... Nd7 22. a4 { p=0.031 legal=33 } 22... Bg7 23. f4 { p=0.038 legal=33 } 23... Rc4 24. fxg5 { p=0.209 legal=32 } 24... Bxe5 25. gxh6 { p=0.082 legal=33 } 25... Rxc3 26. Bf2 { p=0.033 legal=33 } 26... Bxg3 27. Bxg3 { p=0.166 legal=27 } 27... Rxh6 28. Bf2 { p=0.038 legal=34 } 28... Rxh5 29. Re3 { p=0.030 legal=28 } 29... Rxe3 30. Bxe3 { p=0.448 legal=22 } 30... Re5 31. Kf2 { p=0.055 legal=27 } 31... Re4 32. Kf3 { p=0.029 legal=30 } 32... Ne5+ 33. Ke2 { p=0.139 legal=3 } 33... Nc4 34. Kd3 { p=0.108 legal=24 } 34... Nxe3 35. Kd2 { p=0.031 legal=22 } 35... Nxg2 36. Kd3 { p=0.049 legal=22 } 36... Nf4+ 37. Kd2 { p=0.120 legal=3 } 37... Rxd4+ 38. Kc3 { p=0.150 legal=5 } 38... Rd3+ 39. Kc2 { p=0.022 legal=2 } 39... f5 40. Rd1 { p=0.028 legal=13 } 40... Rxd1 41. Kxd1 { p=0.271 legal=5 } 41... Kd7 42. Kd2 { p=0.068 legal=5 } 42... e5 43. Ke3 { p=0.118 legal=7 } 43... Kd6 44. Kf3 { p=0.051 legal=4 } 44... d4 45. Kf2 { p=0.022 legal=3 } 45... e4 46. Kg3 { p=0.051 legal=5 } 46... Ned5 47. Kf2 { p=0.017 legal=4 } 47... e3+ 48. Kf3 { p=0.136 legal=5 } 48... Nd3 49. Ke2 { p=0.069 legal=4 } 49... N5f4+ 50. Kf3 { p=0.093 legal=3 } 50... e2 51. Kg3 { p=0.011 legal=2 } 51... e1=Q+ 52. Kf3 { p=0.134 legal=2 } 52... Nd5 53. Kg2 { p=0.014 legal=2 } 53... N3f4+ 54. Kf3 { p=0.236 legal=2 } 54... Ke7 55. b6 { p=0.001 legal=1 } 55... Qe3# 0-1", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"Stockfish\"]\n[Black \"R\u00e9seau de neurones\"]\n[Result \"1-0\"]\n\n1. d4 Nf6 { p=0.511 legal=20 } 2. Nf3 g6 { p=0.431 legal=22 } 3. c4 Bg7 { p=0.949 legal=23 } 4. Nc3 O-O { p=0.668 legal=26 } 5. Bf4 d6 { p=0.640 legal=25 } 6. e3 Nbd7 { p=0.337 legal=32 } 7. h3 e5 { p=0.523 legal=27 } 8. Bg5 h6 { p=0.004 legal=26 } 9. dxe5 hxg5 { p=0.148 legal=27 } 10. exf6 Nxf6 { p=0.560 legal=23 } 11. Qc2 Re8 { p=0.024 legal=29 } 12. Be2 g4 { p=0.020 legal=34 } 13. hxg4 Nxg4 { p=0.303 legal=31 } 14. Nd4 Ne5 { p=0.074 legal=38 } 15. O-O-O c6 { p=0.072 legal=35 } 16. e4 Qa5 { p=0.047 legal=36 } 17. Qd2 Nxc4 { p=0.028 legal=40 } 18. Bxc4 Qe5 { p=0.041 legal=41 } 19. f4 Qxd4 { p=0.108 legal=35 } 20. Qxd4 Bxd4 { p=0.284 legal=26 } 21. Rxd4 Be6 { p=0.160 legal=21 } 22. Bb3 Bxb3 { p=0.116 legal=27 } 23. axb3 d5 { p=0.075 legal=22 } 24. Kc2 dxe4 { p=0.460 legal=22 } 25. Re1 e3 { p=0.101 legal=23 } 26. Rd7 Rad8 { p=0.103 legal=24 } 27. Rxe3 Rxd7 { p=0.426 legal=22 } 28. Rxe8+ Kg7 { p=0.875 legal=2 } 29. g3 Kf6 { p=0.052 legal=20 } 30. g4 Re7 { p=0.041 legal=16 } 31. Rxe7 Kxe7 { p=0.368 legal=8 } 32. Kd2 Kd6 { p=0.092 legal=15 } 33. Kd3 Kc5 { p=0.083 legal=13 } 34. g5 Kb4 { p=0.056 legal=9 } 35. Ke4 a5 { p=0.071 legal=10 } 36. f5 gxf5+ { p=0.294 legal=8 } 37. Kxf5 a4 { p=0.136 legal=7 } 38. bxa4 Kb3 { p=0.066 legal=8 } 39. Nd1 Kc2 { p=0.027 legal=9 } 40. Ne3+ Kxb2 { p=0.091 legal=6 } 41. Kf6 Ka3 { p=0.090 legal=10 } 42. Nc4+ Ka2 { p=0.144 legal=4 } 43. Ne3 Kb3 { p=0.106 legal=8 } 44. Kxf7 Kb2 { p=0.068 legal=9 } 45. Ng4 Kc3 { p=0.101 legal=11 } 46. g6 Kb2 { p=0.067 legal=11 } 47. a5 Kc3 { p=0.062 legal=11 } 48. Nf2 Kd2 { p=0.074 legal=10 } 49. Ne4+ Ke3 { p=0.049 legal=7 } 50. Nc5 Kd4 { p=0.037 legal=8 } 51. Nxb7 c5 { p=0.036 legal=8 } 52. Nxc5 Kc4 { p=0.056 legal=6 } 53. g7 Kd5 { p=0.054 legal=6 } 54. a6 Kxc5 { p=0.048 legal=6 } 55. a7 Kd6 { p=0.015 legal=8 } 56. g8=Q Kd7 { p=0.041 legal=6 } 57. a8=Q Kd6 { p=0.021 legal=2 } 58. Qg4 Ke5 { p=0.040 legal=3 } 59. Qge4+ Kd6 { p=0.024 legal=1 } 60. Qed5+ Kc7 { p=0.024 legal=1 } 61. Qab7# 1-0", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"R\u00e9seau de neurones\"]\n[Black \"Stockfish\"]\n[Result \"0-1\"]\n\n1. e4 { p=0.430 legal=20 } 1... c6 2. d4 { p=0.475 legal=30 } 2... e6 3. Nc3 { p=0.459 legal=38 } 3... d5 4. Nf3 { p=0.623 legal=39 } 4... dxe4 5. Nxe4 { p=0.990 legal=37 } 5... Be7 6. Bd3 { p=0.710 legal=40 } 6... Nd7 7. O-O { p=0.622 legal=42 } 7... Ngf6 8. Re1 { p=0.266 legal=38 } 8... O-O 9. c3 { p=0.208 legal=40 } 9... a5 10. Bg5 { p=0.178 legal=43 } 10... Re8 11. Nxf6+ { p=0.132 legal=46 } 11... Nxf6 12. Ne5 { p=0.192 legal=48 } 12... Ra7 13. Qf3 { p=0.089 legal=55 } 13... h6 14. Bh4 { p=0.410 legal=59 } 14... Rf8 15. Rad1 { p=0.058 legal=54 } 15... Qc7 16. Bg3 { p=0.033 legal=51 } 16... Qb6 17. a4 { p=0.032 legal=47 } 17... Qd8 18. h3 { p=0.014 legal=45 } 18... Qb6 19. Nc4 { p=0.015 legal=46 } 19... Qd8 20. Ne5 { p=0.081 legal=49 } 20... Bd7 21. Qf4 { p=0.020 legal=46 } 21... Be8 22. Ng6 { p=0.015 legal=48 } 22... fxg6 23. Qe5 { p=0.114 legal=46 } 23... Kh7 24. Qxf6 { p=0.034 legal=47 } 24... Rxf6 25. Be4 { p=0.288 legal=37 } 25... b5 26. axb5 { p=0.293 legal=34 } 26... cxb5 27. Be5 { p=0.137 legal=35 } 27... Rf7 28. Bc6 { p=0.055 legal=38 } 28... Bxc6 29. Re4 { p=0.229 legal=29 } 29... Bxe4 30. d5 { p=0.027 legal=27 } 30... Ra6 31. dxe6 { p=0.308 legal=30 } 31... Qxd1+ 32. Kh2 { p=0.663 legal=1 } 32... Rxf2 33. Kg3 { p=0.020 legal=13 } 33... Rxg2+ 34. Kf4 { p=0.231 legal=1 } 34... Qf3# 0-1", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"Stockfish\"]\n[Black \"R\u00e9seau de neurones\"]\n[Result \"1-0\"]\n\n1. e4 e5 { p=0.268 legal=20 } 2. d4 exd4 { p=0.700 legal=30 } 3. Ne2 Nc6 { p=0.290 legal=30 } 4. a3 Nf6 { p=0.454 legal=32 } 5. Qd3 d6 { p=0.174 legal=29 } 6. Nxd4 Be7 { p=0.253 legal=33 } 7. Be3 O-O { p=0.650 legal=33 } 8. Nxc6 bxc6 { p=0.956 legal=26 } 9. h3 Re8 { p=0.157 legal=26 } 10. Nc3 Be6 { p=0.089 legal=26 } 11. O-O-O Nd7 { p=0.148 legal=31 } 12. f4 Nc5 { p=0.102 legal=34 } 13. Bxc5 dxc5 { p=0.787 legal=31 } 14. Qa6 Qxd1+ { p=0.092 legal=35 } 15. Nxd1 Rad8 { p=0.061 legal=31 } 16. Qe2 c4 { p=0.067 legal=36 } 17. Qe1 Bf6 { p=0.057 legal=37 } 18. Be2 Bd4 { p=0.035 legal=35 } 19. Bf3 c5 { p=0.041 legal=35 } 20. Bh5 g6 { p=0.045 legal=32 } 21. Bxg6 hxg6 { p=0.610 legal=36 } 22. g4 c3 { p=0.020 legal=33 } 23. b3 Bxb3 { p=0.010 legal=33 } 24. Nxc3 Ba2 { p=0.032 legal=36 } 25. Nxa2 c4 { p=0.023 legal=32 } 26. e5 c3 { p=0.115 legal=31 } 27. Nb4 c5 { p=0.030 legal=27 } 28. Nc6 Rd7 { p=0.242 legal=24 } 29. Qg3 Red8 { p=0.018 legal=28 } 30. Qf3 Re8 { p=0.073 legal=24 } 31. a4 Kg7 { p=0.034 legal=28 } 32. Na5 Red8 { p=0.017 legal=30 } 33. Nb7 Rc8 { p=0.081 legal=27 } 34. Rd1 Rxb7 { p=0.024 legal=30 } 35. Rxd4 cxd4 { p=0.177 legal=31 } 36. f5 gxf5 { p=0.069 legal=32 } 37. gxf5 d3 { p=0.075 legal=30 } 38. Qg2+ Kh6 { p=0.019 legal=4 } 39. Qxb7 d2+ { p=0.129 legal=20 } 40. Kd1 Rd8 { p=0.052 legal=18 } 41. Qxf7 Kg5 { p=0.030 legal=15 } 42. Qf6+ Kf4 { p=0.067 legal=2 } 43. Qxd8 Kxe5 { p=0.079 legal=8 } 44. Qd3 Kf4 { p=0.056 legal=4 } 45. Qc4+ Ke3 { p=0.068 legal=6 } 46. Qxc3+ Ke4 { p=0.031 legal=3 } 47. Kxd2 Kxf5 { p=0.076 legal=5 } 48. Qa5+ Ke4 { p=0.144 legal=5 } 49. Qxa7 Kf5 { p=0.037 legal=5 } 50. Qb6 Ke4 { p=0.101 legal=4 } 51. Qa5 Kd4 { p=0.048 legal=3 } 52. Kc1 Ke3 { p=0.059 legal=3 } 53. Qa7+ Kf4 { p=0.035 legal=4 } 54. Kd1 Kf3 { p=0.066 legal=6 } 55. Ke1 Ke4 { p=0.022 legal=4 } 56. c4 Kd3 { p=0.049 legal=5 } 57. c5 Kc3 { p=0.040 legal=6 } 58. c6 Kb4 { p=0.031 legal=6 } 59. Qg7 Kc4 { p=0.056 legal=6 } 60. c7 Kb4 { p=0.050 legal=5 } 61. Kd1 Kc4 { p=0.057 legal=6 } 62. c8=Q+ Kb3 { p=0.073 legal=4 } 63. Ke1 Ka3 { p=0.018 legal=4 } 64. Qe5 Ka2 { p=0.076 legal=4 } 65. Qc2+ Ka3 { p=0.018 legal=1 } 66. Qd6# 1-0", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"R\u00e9seau de neurones\"]\n[Black \"Stockfish\"]\n[Result \"0-1\"]\n\n1. e4 { p=0.430 legal=20 } 1... c6 2. d4 { p=0.475 legal=30 } 2... d6 3. Nc3 { p=0.527 legal=38 } 3... d5 4. e5 { p=0.001 legal=39 } 4... Bd7 5. Nf3 { p=0.068 legal=39 } 5... Bf5 6. Bd3 { p=0.005 legal=36 } 6... Bg6 7. O-O { p=0.008 legal=41 } 7... e6 8. Ne2 { p=0.007 legal=36 } 8... Bxd3 9. Qxd3 { p=0.705 legal=29 } 9... a5 10. c3 { p=0.055 legal=39 } 10... a4 11. Ng3 { p=0.021 legal=35 } 11... Ne7 12. Re1 { p=0.029 legal=37 } 12... Ng6 13. h4 { p=0.058 legal=41 } 13... Nxh4 14. Nxh4 { p=0.110 legal=42 } 14... Qxh4 15. Nh5 { p=0.063 legal=39 } 15... Qxh5 16. Bf4 { p=0.063 legal=37 } 16... Nd7 17. Rec1 { p=0.059 legal=42 } 17... Rb8 18. Bg5 { p=0.053 legal=37 } 18... Qxg5 19. f4 { p=0.073 legal=34 } 19... Qxf4 20. Qg3 { p=0.025 legal=30 } 20... Qxg3 21. Kf1 { p=0.094 legal=12 } 21... a3 22. bxa3 { p=0.312 legal=11 } 22... Bxa3 23. Rc2 { p=0.176 legal=8 } 23... h5 24. Rb1 { p=0.026 legal=12 } 24... Qd3+ 25. Ke1 { p=0.038 legal=4 } 25... Qe3+ 26. Re2 { p=0.011 legal=3 } 26... Qg1+ 27. Kd2 { p=0.106 legal=1 } 27... Qxb1 28. Ke3 { p=0.041 legal=8 } 28... Qc1+ 29. Kf2 { p=0.059 legal=4 } 29... Qxc3 30. Re3 { p=0.024 legal=10 } 30... Qxe3+ 31. Kxe3 { p=0.846 legal=2 } 31... h4 32. Kf4 { p=0.256 legal=8 } 32... Ra8 33. Kg5 { p=0.194 legal=6 } 33... Bb2 34. Kf4 { p=0.059 legal=6 } 34... Ra3 35. Kg5 { p=0.080 legal=4 } 35... Bxd4 36. Kf4 { p=0.065 legal=4 } 36... Bxe5+ 37. Kg5 { p=0.121 legal=2 } 37... Rg3# 0-1", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"Stockfish\"]\n[Black \"R\u00e9seau de neurones\"]\n[Result \"1-0\"]\n\n1. e4 e5 { p=0.268 legal=20 } 2. d4 exd4 { p=0.700 legal=30 } 3. Bd3 Nf6 { p=0.317 legal=29 } 4. Ne2 c5 { p=0.186 legal=27 } 5. Bf4 Nc6 { p=0.635 legal=26 } 6. O-O Be7 { p=0.247 legal=30 } 7. e5 Nd5 { p=0.617 legal=30 } 8. c3 O-O { p=0.107 legal=37 } 9. cxd4 cxd4 { p=0.131 legal=36 } 10. Nd2 Nxf4 { p=0.104 legal=36 } 11. Nxf4 Nxe5 { p=0.298 legal=30 } 12. Bxh7+ Kh8 { p=0.639 legal=2 } 13. Qh5 g6 { p=0.051 legal=31 } 14. Bxg6+ Kg8 { p=0.065 legal=2 } 15. Qh7# 1-0", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"R\u00e9seau de neurones\"]\n[Black \"Stockfish\"]\n[Result \"0-1\"]\n\n1. e4 { p=0.430 legal=20 } 1... c6 2. d4 { p=0.475 legal=30 } 2... e6 3. Nc3 { p=0.459 legal=38 } 3... d5 4. Nf3 { p=0.623 legal=39 } 4... dxe4 5. Nxe4 { p=0.990 legal=37 } 5... Be7 6. Bd3 { p=0.710 legal=40 } 6... Nd7 7. O-O { p=0.622 legal=42 } 7... Ngf6 8. Re1 { p=0.266 legal=38 } 8... a5 9. c3 { p=0.160 legal=40 } 9... a4 10. Nxf6+ { p=0.070 legal=42 } 10... Bxf6 11. Bf4 { p=0.050 legal=43 } 11... O-O 12. Qc2 { p=0.044 legal=51 } 12... h5 13. Rad1 { p=0.077 legal=53 } 13... g6 14. h4 { p=0.069 legal=49 } 14... a3 15. bxa3 { p=0.246 legal=49 } 15... Bg7 16. Be4 { p=0.016 legal=48 } 16... Nf6 17. Bd3 { p=0.057 legal=44 } 17... Ra5 18. Ne5 { p=0.073 legal=48 } 18... Nd5 19. Bd2 { p=0.051 legal=45 } 19... Rxa3 20. Be4 { p=0.062 legal=40 } 20... Qxh4 21. Bxd5 { p=0.026 legal=36 } 21... exd5 22. Bf4 { p=0.037 legal=35 } 22... Qxf4 23. Nd3 { p=0.024 legal=34 } 23... Qc7 24. Ne5 { p=0.066 legal=32 } 24... Be6 25. Qb3 { p=0.046 legal=36 } 25... Ra6 26. Nd3 { p=0.043 legal=38 } 26... Raa8 27. Nc5 { p=0.099 legal=36 } 27... Qf4 28. Qxb7 { p=0.108 legal=37 } 28... Qd6 29. Qb6 { p=0.034 legal=43 } 29... Bg4 30. Rd2 { p=0.058 legal=42 } 30... Bc8 31. Qc7 { p=0.024 legal=47 } 31... Qxc7 32. Re7 { p=0.086 legal=34 } 32... Qxe7 33. Nd3 { p=0.040 legal=23 } 33... Ra3 34. Nf4 { p=0.128 legal=19 } 34... Qe1+ 35. Kh2 { p=0.166 legal=1 } 35... Qxd2 36. Nxd5 { p=0.077 legal=14 } 36... cxd5 37. Kg3 { p=0.053 legal=8 } 37... Rxa2 38. Kf3 { p=0.033 legal=6 } 38... Bg4+ 39. Kg3 { p=0.041 legal=1 } 39... Qxf2+ 40. Kh2 { p=0.112 legal=1 } 40... Qxg2# 0-1", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"Stockfish\"]\n[Black \"R\u00e9seau de neurones\"]\n[Result \"1-0\"]\n\n1. e4 e5 { p=0.268 legal=20 } 2. Bc4 Nf6 { p=0.594 legal=29 } 3. d3 Nc6 { p=0.321 legal=27 } 4. Bg5 Bc5 { p=0.413 legal=28 } 5. Nd2 d6 { p=0.305 legal=35 } 6. Nb3 Bb6 { p=0.392 legal=39 } 7. Bb5 h6 { p=0.036 legal=31 } 8. Be3 O-O { p=0.061 legal=32 } 9. Qd2 Be6 { p=0.043 legal=34 } 10. Nf3 Ne7 { p=0.033 legal=40 } 11. Bxb6 axb6 { p=0.739 legal=39 } 12. d4 exd4 { p=0.104 legal=42 } 13. Nbxd4 Nxe4 { p=0.050 legal=42 } 14. Qe3 Bd5 { p=0.071 legal=44 } 15. c4 Bxc4 { p=0.065 legal=36 } 16. Bxc4 d5 { p=0.127 legal=34 } 17. Bd3 c5 { p=0.092 legal=36 } 18. Ne2 Nf5 { p=0.070 legal=36 } 19. Qc1 Rc8 { p=0.021 legal=41 } 20. O-O c4 { p=0.023 legal=35 } 21. Bc2 Nd4 { p=0.026 legal=37 } 22. Nfxd4 Nc5 { p=0.076 legal=31 } 23. Qd2 Ne4 { p=0.124 legal=28 } 24. Qc1 Nc5 { p=0.076 legal=31 } 25. Ng3 Qf6 { p=0.088 legal=28 } 26. Nb5 d4 { p=0.073 legal=37 } 27. Bb1 d3 { p=0.071 legal=34 } 28. Rd1 Ne4 { p=0.037 legal=37 } 29. Nxe4 Qe5 { p=0.161 legal=32 } 30. Nbc3 Qd4 { p=0.062 legal=38 } 31. Qd2 Rfd8 { p=0.047 legal=28 } 32. Rf1 Rc5 { p=0.016 legal=29 } 33. Rd1 Re5 { p=0.055 legal=36 } 34. Re1 Qxe4 { p=0.021 legal=36 } 35. Nxe4 Rd4 { p=0.113 legal=30 } 36. f3 Rf5 { p=0.019 legal=26 } 37. b3 c3 { p=0.065 legal=25 } 38. Qxc3 Re5 { p=0.030 legal=27 } 39. Qxd4 d2 { p=0.020 legal=21 } 40. Qd8+ Kh7 { p=0.376 legal=2 } 41. Ng5# 1-0", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"R\u00e9seau de neurones\"]\n[Black \"Stockfish\"]\n[Result \"0-1\"]\n\n1. e4 { p=0.430 legal=20 } 1... e5 2. Nf3 { p=0.735 legal=29 } 2... Nc6 3. Bb5 { p=0.659 legal=27 } 3... a6 4. Ba4 { p=0.927 legal=32 } 4... b5 5. Bb3 { p=0.952 legal=26 } 5... Bb7 6. O-O { p=0.397 legal=28 } 6... Bc5 7. c3 { p=0.606 legal=26 } 7... Bb6 8. d4 { p=0.339 legal=26 } 8... d6 9. Re1 { p=0.209 legal=34 } 9... h6 10. Nbd2 { p=0.191 legal=35 } 10... exd4 11. cxd4 { p=0.823 legal=30 } 11... Bxd4 12. Nxd4 { p=0.348 legal=28 } 12... Nxd4 13. Nf3 { p=0.055 legal=30 } 13... Nxb3 14. axb3 { p=0.875 legal=32 } 14... Ne7 15. Nd4 { p=0.143 legal=34 } 15... Ng6 16. Be3 { p=0.185 legal=38 } 16... Qf6 17. Rc1 { p=0.064 legal=40 } 17... Rc8 18. f3 { p=0.045 legal=38 } 18... Ne7 19. Qd2 { p=0.060 legal=35 } 19... O-O 20. h4 { p=0.032 legal=40 } 20... c5 21. Ne2 { p=0.100 legal=38 } 21... Rfd8 22. Ng3 { p=0.097 legal=38 } 22... Nc6 23. Nf5 { p=0.098 legal=40 } 23... d5 24. exd5 { p=0.247 legal=43 } 24... Rxd5 25. Qxd5 { p=0.049 legal=41 } 25... c4 26. bxc4 { p=0.070 legal=49 } 26... Re8 27. cxb5 { p=0.025 legal=49 } 27... Qe5 28. bxc6 { p=0.023 legal=54 } 28... Qxd5 29. c7 { p=0.040 legal=37 } 29... Qxf5 30. Bf2 { p=0.033 legal=34 } 30... Rc8 31. Re7 { p=0.027 legal=32 } 31... Kh7 32. Rxf7 { p=0.020 legal=35 } 32... Qxf7 33. Be3 { p=0.040 legal=26 } 33... Qb3 34. Bd4 { p=0.040 legal=27 } 34... Qb4 35. Be3 { p=0.033 legal=28 } 35... g6 36. Bd4 { p=0.031 legal=28 } 36... Qxd4+ 37. Kh1 { p=0.309 legal=3 } 37... Qxh4+ 38. Kg1 { p=0.130 legal=1 } 38... Bxf3 39. gxf3 { p=0.554 legal=16 } 39... Qd4+ 40. Kg2 { p=0.266 legal=4 } 40... Qd2+ 41. Kg3 { p=0.178 legal=5 } 41... Qxc1 42. Kf2 { p=0.046 legal=9 } 42... Rxc7 43. Kg3 { p=0.054 legal=6 } 43... Qxb2 44. Kf4 { p=0.047 legal=5 } 44... Qc3 45. Ke4 { p=0.148 legal=3 } 45... Rc4+ 46. Kd5 { p=0.132 legal=1 } 46... Rd4+ 47. Ke6 { p=0.035 legal=2 } 47... Kg7 48. Ke7 { p=0.034 legal=3 } 48... Qe1# 0-1", "[Event \"?\"]\n[Site \"?\"]\n[Date \"????.??.??\"]\n[Round \"?\"]\n[White \"Stockfish\"]\n[Black \"R\u00e9seau de neurones\"]\n[Result \"1-0\"]\n\n1. c4 e5 { p=0.241 legal=20 } 2. Nc3 Nf6 { p=0.454 legal=30 } 3. e3 Nc6 { p=0.289 legal=28 } 4. d4 exd4 { p=0.412 legal=31 } 5. Nb5 Bc5 { p=0.145 legal=30 } 6. exd4 Bb6 { p=0.376 legal=34 } 7. d5 Ne5 { p=0.313 legal=30 } 8. d6 cxd6 { p=0.535 legal=31 } 9. Bf4 O-O { p=0.070 legal=32 } 10. Qd2 Ng6 { p=0.047 legal=30 } 11. Bxd6 Re8+ { p=0.290 legal=26 } 12. Kd1 Ne4 { p=0.050 legal=32 } 13. Qc1 Nxf2+ { p=0.042 legal=37 } 14. Kc2 Nd3 { p=0.026 legal=38 } 15. Bxd3 Re1 { p=0.045 legal=34 } 16. Qxe1 Qh4 { p=0.034 legal=28 } 17. Qe8+ Nf8 { p=0.013 legal=1 } 18. Qxf8# 1-0"];
let positions = [], moves = [], currentPos = 0, playInterval = null, gameHeaders = {};

function fenToBoard(fen) {
  const rows = fen.split(' ')[0].split('/');
  const board = [];
  for (const row of rows) {
    const r = [];
    for (const c of row) {
      if (c >= '1' && c <= '8') for (let i = 0; i < +c; i++) r.push('');
      else r.push(c);
    }
    board.push(r);
  }
  return board;
}

function loadGame(idx) {
  const pgn = pgns[idx];

  positions = ['rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1'];
  moves = [];

  if (typeof Chess !== 'undefined') {
    const game = new Chess();
    game.load_pgn(pgn);
    const history = game.history();
    moves = history;

    // Rejouer pour capturer les FEN
    game.reset();
    for (const m of history) {
      game.move(m);
      positions.push(game.fen());
    }
  }

  currentPos = 0;
  render();
  renderMoveList();

  // Headers
  gameHeaders = {};
  pgn.split('\n').forEach(l => {
    const m = l.match(/^\[(\w+)\s+"(.+)"\]/);
    if (m) gameHeaders[m[1]] = m[2];
  });
  const wName = gameHeaders.White || 'Blancs';
  const bName = gameHeaders.Black || 'Noirs';
  const isModelWhite = wName.includes('seau');
  document.getElementById('whiteName').textContent = wName;
  document.getElementById('blackName').textContent = bName;
  document.getElementById('whiteTag').textContent = isModelWhite ? 'ü§ñ r√©seau de neurones' : '‚ôü stockfish';
  document.getElementById('whiteTag').className = 'player-tag ' + (isModelWhite ? 'model' : 'stockfish');
  document.getElementById('blackTag').textContent = isModelWhite ? '‚ôü stockfish' : 'ü§ñ r√©seau de neurones';
  document.getElementById('blackTag').className = 'player-tag ' + (isModelWhite ? 'stockfish' : 'model');
  document.getElementById('info').textContent = `R√©sultat : ${gameHeaders.Result || '?'}`;
}

function render() {
  const fen = positions[currentPos] || positions[0];
  const board = fenToBoard(fen);
  const turn = (fen.split(' ')[1] || 'w') === 'w' ? 'white' : 'black';
  let html = '';

  for (let r = 0; r < 8; r++) {
    html += '<div class="row">';
    for (let c = 0; c < 8; c++) {
      const light = (r + c) % 2 === 0;
      const piece = board[r][c];
      const colorCls = piece ? (WHITE_PIECES.has(piece) ? 'white-piece' : 'black-piece') : '';
      html += `<div class="sq ${light?'light':'dark'} ${colorCls}">${piece ? PIECES[piece] || '' : ''}</div>`;
    }
    html += '</div>';
  }
  document.getElementById('board').innerHTML = html;

  // Mettre √† jour qui joue
  document.getElementById('whiteTurn').textContent = turn === 'white' ? '‚óÑ au trait' : '';
  document.getElementById('blackTurn').textContent = turn === 'black' ? '‚óÑ au trait' : '';

  renderMoveList();
}

function renderMoveList() {
  let html = '';
  for (let i = 0; i < moves.length; i++) {
    if (i % 2 === 0) html += `${Math.floor(i/2)+1}. `;
    const cls = i === currentPos - 1 ? 'current' : '';
    html += `<span class="${cls}" style="cursor:pointer" onclick="goTo(${i+1})">${moves[i]}</span> `;
  }
  document.getElementById('moveList').innerHTML = html;
}

function step(dir) {
  const next = currentPos + dir;
  if (next >= 0 && next < positions.length) { currentPos = next; render(); }
}

function goTo(idx) {
  if (idx >= 0 && idx < positions.length) { currentPos = idx; render(); }
}

function togglePlay() {
  if (playInterval) {
    clearInterval(playInterval);
    playInterval = null;
    document.getElementById('playBtn').textContent = '‚ñ∂ Play';
  } else {
    document.getElementById('playBtn').textContent = '‚è∏ Pause';
    playInterval = setInterval(() => {
      if (currentPos >= positions.length - 1) { togglePlay(); return; }
      step(1);
    }, 800);
  }
}

// Populate game selector
pgns.forEach((pgn, i) => {
  const opt = document.createElement('option');
  const headers = {};
  pgn.split('\n').forEach(l => {
    const m = l.match(/^\[(\w+)\s+"(.+)"\]/);
    if (m) headers[m[1]] = m[2];
  });
  opt.value = i;
  opt.textContent = `Partie ${i+1}: ${headers.White||'?'} vs ${headers.Black||'?'} (${headers.Result||'?'})`;
  document.getElementById('gameSelect').appendChild(opt);
});

// Load chess.js from CDN for move replay
const s = document.createElement('script');
s.src = 'https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js';
s.onload = () => loadGame(0);
document.head.appendChild(s);
</script>
</body>
</html>